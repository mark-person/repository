<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>个人知识库</title>
<link th:replace="common/fragment::mobile"/>
<script type="text/javascript" th:inline="javascript">
var controllerPath = contextPath + "auto/mobile/";
var searchMethod = "listTodo";
function getQueryString(pageNumber) {
	return {pageNumber:pageNumber};
}

function back() {
	location.href = "/auto/mobile/my";
}



</script>

<style type="text/css">
body {margin-top:2.75rem;margin-bottom:3rem}
.top-div {position:fixed;top:0;background-color:#f0f0f0;padding:.2rem 0;width:25.875rem;display:flex;justify-content:space-between; padding-left:0.5rem;padding-right:0.5rem;}
input::-webkit-input-placeholder {padding-top:0.175rem;}

.row {padding-left:0.8rem;padding-right:0.8rem}
</style>
</head>

<body>

<div class="top-div">
	<div style="position:fixed; z-index:9999;opacity:0.5;margin-top:-0.4rem;margin-left:0.4rem;cursor:pointer;" id="backDiv">
		<div onclick="back();" style=""><span style="font-size: 2.2rem;" class="iconfont icon-fanhui5"></span></div>
	</div>
	
	<div style="text-align: right; width:10rem">
		<span class="iconfont icon-tianjia" style="font-size:1.6rem;cursor: pointer;"></span>
	</div>
	<div>
		<form id="form" style="width:10rem;" action="javascript:;">
			<input type="search" id="word" class="form-control" placeholder="🔍">
		</form>
	</div>
</div>

<div class="container" style="padding:0px">
<div class="panel panel-default">
	<ul class="list-group" id="knowDiv"></ul>
</div>
</div>


<script th:src="@{/static/cdn/template-3.0.0.js}" type="text/javascript" ></script>
<script id="itemTemplate" type="text/html">
{{each list as v i}}
<li class="list-group-item" onclick="location.href='/auto/mobile/todo?id={{v.todoId}}'" style="cursor: pointer;">
	<div class="row" style="display: flex;justify-content:space-between;">
		<div><span class="iconfont icon-zhongyaotixing_Pro" style="color:orange;font-size:1.8rem"></div>
		<div style="width:16.5rem;height:2.6rem;" class="ellipsis2">{{v.todoTitle}}
			我们是中国人 我们是中国人 我们是中国人 我们是中国人 结束了 1111 结束了  222
		</div>
		<div style="color:gray;font-size:0.815rem;">
			
			<span class="iconfont icon-weiwangguanicon-defuben-" style="color:blue;font-size:1.8rem;"></span>
			<span style="font-size:0.815rem;" class="iconfont icon-xiangyou"></span>
		</div>
  	</div>
</li>
{{/each}}
</script>
<script type="text/javascript" th:inline="javascript">
var pageHasMore = true;
var currentPageNumber = 1;
$(window).scroll(function() {
    if ($(this).scrollTop() + $(document).height() >= $(this).height() - 50) {
    	if (pageHasMore) {
    		pageHasMore = false;
    		currentPageNumber++;
    		$("#pageMsg div").hide();
    		$("#pageLoading").show();
    		queryPage(currentPageNumber);
    	}
    }
});
function queryPage(pageNumber) {
	$.post(controllerPath + searchMethod, getQueryString(pageNumber), function(r) {
		if (pageNumber == 1) {
			currentPageNumber = 1;
			$("#knowDiv").html(template("itemTemplate", r));
		}
		else {
			$("#knowDiv").append(template("itemTemplate", r));
		}
		
		$("#pageMsg div").hide();
		if (r.page.pageSize * r.page.pageNumber < r.page.totalRows) {
			pageHasMore = true;
			$("#pageMore").show();
		}
		else {
			$("#pageEnd").show();
		}
	});
}
function view(kId) {
	top.location.href = controllerPath + "view?id=" + kId;
}

var list = [[${list}]];
if (list == null) {
	alert("list不能为null");
}
$(function() {
	$("#knowDiv").append(template("itemTemplate", list));
	if (list.page.totalRows <= list.page.pageSize) {
		pageHasMore = false;
		$("#pageEnd").show();
	}
})
</script>
<div id="pageMsg">
	<div id="pageMore"><p>-- 上拉加载更多 --</p></div>
	<div id="pageLoading"><p>-- 加载中... --</p></div>
	<div id="pageEnd"><p>-- 暂时就这么多了 --</p></div>
</div>


</body>
</html>












